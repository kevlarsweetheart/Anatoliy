Код конечно не причесан но зато WORK.
